import{j as e,r as o,dX as B,dY as O,aS as U,aT as V,B as v,ao as _,aU as G,aV as R,aW as q,bC as J,bu as u,I as h,b6 as N,bD as W,v as C,y as X,D as Y,E as p,G as d,H as Z,J as t,ai as F,dZ as $,d_ as K,q as Q,af as ee,ag as ae,ah as T}from"./index-BzQLEEGE.js";function se(){const[n,w]=o.useState(""),[x,D]=o.useState("all"),[y,j]=o.useState(!1),[i,c]=o.useState({feature:"",module:"",description:"",enabled:!1}),{user:s}=B(),{useFeatureToggles:S,useCreateFeatureToggle:L,useEnableFeature:A,useDisableFeature:I}=O(),{data:r,isLoading:P}=S(x!=="all"?x:void 0,s==null?void 0:s.companyId),g=L(),f=A(),b=I(),m=r==null?void 0:r.filter(a=>{var l;return a.feature.toLowerCase().includes(n.toLowerCase())||((l=a.description)==null?void 0:l.toLowerCase().includes(n.toLowerCase()))||a.module.toLowerCase().includes(n.toLowerCase())}),z=r?Array.from(new Set(r.map(a=>a.module))):[],E=(a,l)=>{s!=null&&s.id&&(l?f.mutate({id:a.id,userId:s.id}):b.mutate({id:a.id,userId:s.id}))},M=()=>{s!=null&&s.companyId&&(g.mutate({...i,companyId:s.companyId,metadata:{}}),j(!1),c({feature:"",module:"",description:"",enabled:!1}))},k=e.jsxs(U,{open:y,onOpenChange:j,children:[e.jsx(V,{asChild:!0,children:e.jsxs(v,{children:[e.jsx(_,{className:"mr-2 h-4 w-4"}),"Adaugă Funcționalitate"]})}),e.jsxs(G,{children:[e.jsxs(R,{children:[e.jsx(q,{children:"Adaugă o nouă funcționalitate"}),e.jsx(J,{children:"Creează un nou feature toggle pentru a activa sau dezactiva funcționalități."})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(u,{htmlFor:"feature",className:"text-right",children:"Nume"}),e.jsx(h,{id:"feature",placeholder:"ex: enable_export_pdf",className:"col-span-3",value:i.feature,onChange:a=>c({...i,feature:a.target.value})})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(u,{htmlFor:"module",className:"text-right",children:"Modul"}),e.jsx(h,{id:"module",placeholder:"ex: invoicing",className:"col-span-3",value:i.module,onChange:a=>c({...i,module:a.target.value})})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(u,{htmlFor:"description",className:"text-right",children:"Descriere"}),e.jsx(h,{id:"description",placeholder:"Funcționalitate pentru export PDF",className:"col-span-3",value:i.description,onChange:a=>c({...i,description:a.target.value})})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(u,{htmlFor:"enabled",className:"text-right",children:"Activat"}),e.jsx("div",{className:"col-span-3",children:e.jsx(N,{id:"enabled",checked:i.enabled,onCheckedChange:a=>c({...i,enabled:a})})})]})]}),e.jsx(W,{children:e.jsx(v,{type:"submit",onClick:M,disabled:!i.feature||!i.module||g.isPending,children:g.isPending?e.jsxs(e.Fragment,{children:[e.jsx(C,{className:"mr-2 h-4 w-4 animate-spin"}),"Se creează..."]}):"Salvează"})})]})]}),H=e.jsx("div",{className:"rounded-md border",children:e.jsxs(X,{children:[e.jsx(Y,{children:e.jsxs(p,{children:[e.jsx(d,{children:"Funcționalitate"}),e.jsx(d,{children:"Modul"}),e.jsx(d,{children:"Descriere"}),e.jsx(d,{children:"Status"}),e.jsx(d,{className:"text-right",children:"Acțiuni"})]})}),e.jsx(Z,{children:m&&m.length>0?m.map(a=>e.jsxs(p,{children:[e.jsx(t,{className:"font-medium",children:a.feature}),e.jsx(t,{children:e.jsx(F,{variant:"outline",className:"capitalize",children:a.module})}),e.jsx(t,{children:a.description||"Nicio descriere"}),e.jsx(t,{children:e.jsx(F,{variant:a.isEnabled?"default":"secondary",className:`font-normal ${a.isEnabled?"bg-green-100 text-green-800 hover:bg-green-200":""}`,children:a.isEnabled?"Activat":"Dezactivat"})}),e.jsx(t,{className:"text-right",children:e.jsx(N,{checked:a.isEnabled,onCheckedChange:l=>E(a,l),disabled:f.isPending||b.isPending})})]},a.id)):e.jsx(p,{children:e.jsx(t,{colSpan:5,className:"h-24 text-center",children:n?"Nu au fost găsite funcționalități care să corespundă căutării.":"Nu există funcționalități configurate."})})})]})});return e.jsxs("div",{className:"flex flex-col space-y-6",children:[e.jsx($,{title:"Funcționalități (Feature Toggles)",description:"Activați sau dezactivați funcționalități în aplicație.",breadcrumbs:[{title:"Funcționalități"}],actions:k}),e.jsx(K,{title:"Funcționalități disponibile",description:"Gestionați funcționalitățile disponibile în aplicație prin activarea sau dezactivarea lor.",children:e.jsxs("div",{className:"flex flex-col space-y-4",children:[e.jsxs("div",{className:"flex flex-col space-y-4 md:flex-row md:space-y-0 md:space-x-4 mb-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(Q,{className:"absolute left-2 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(h,{placeholder:"Căutare funcționalități...",className:"pl-8",value:n,onChange:a=>w(a.target.value)})]}),e.jsx(ee,{defaultValue:"all",value:x,onValueChange:D,className:"w-full md:w-auto",children:e.jsxs(ae,{className:"w-full md:w-auto",children:[e.jsx(T,{value:"all",children:"Toate"}),z.map(a=>e.jsx(T,{value:a,children:a.charAt(0).toUpperCase()+a.slice(1)},a))]})})]}),P?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx(C,{className:"h-8 w-8 animate-spin text-primary"})}):H]})})]})}function le(){return e.jsx(se,{})}export{le as default};
