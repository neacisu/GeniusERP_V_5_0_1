import{ak as f,bB as y}from"./index-BzQLEEGE.js";function d(e={}){const{page:t=1,limit:r=20,searchTerm:o="",type:a,status:s,sortBy:i="createdAt",sortDirection:c="desc"}=e,n=new URLSearchParams;n.append("page",t.toString()),n.append("limit",r.toString()),o&&n.append("searchTerm",o),a&&n.append("type",a),s&&n.append("status",s),i&&n.append("sortBy",i),c&&n.append("sortDirection",c);const h=`/api/crm/companies?${n.toString()}`;return f({queryKey:["/api/crm/companies",t,r,o,a,s,i,c],queryFn:async()=>{const u=m();if(!u)throw new Error("Authentication token not found");const p=await fetch(h,{headers:{Authorization:`Bearer ${u}`}});if(!p.ok)throw new Error("Failed to fetch companies");return p.json()},refetchOnWindowFocus:!1,retry:1})}function m(){let e=sessionStorage.getItem("accessToken");if(e)return e;try{const t=localStorage.getItem("user");if(t){const r=JSON.parse(t);if(r&&r.token)return r.token}}catch(t){console.error("Error getting token from localStorage",t)}return e=localStorage.getItem("auth_token")||localStorage.getItem("authToken")||sessionStorage.getItem("auth_token"),e}function k(e){return f({queryKey:["/api/crm/companies",e],queryFn:async()=>{const t=m();if(!t)throw new Error("Authentication token not found");const r=await fetch(`/api/crm/companies/${e}`,{headers:{Authorization:`Bearer ${t}`}});if(!r.ok)throw r.status===404?new Error("Company not found"):new Error("Failed to fetch company");return r.json()},refetchOnWindowFocus:!1,retry:1,enabled:!!e})}function w(){return y.invalidateQueries({queryKey:["/api/crm/companies"]})}export{k as a,w as i,d as u};
