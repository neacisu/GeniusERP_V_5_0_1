import{u as q,r as m,j as e,bP as J,B as x,aF as K,q as U,I as W,a3 as C,a4 as v,a5 as b,a6 as I,a7 as c,aJ as P,aK as R,by as G,aM as F,cg as H,aO as D,aN as o,g as O,h as M,cy as X,cm as Y,cz as Z,ar as _,ai as ee,ay as se,ao as ae}from"./index-BzQLEEGE.js";import{C as te}from"./CRMModuleLayout-Dn1kMNZ5.js";const u=[{id:"1",name:"Pipeline Principal",isDefault:!0,stages:[{id:"s1",name:"Calificare",color:"#99D126",order:1},{id:"s2",name:"Demonstrație",color:"#88C506",order:2},{id:"s3",name:"Propunere",color:"#F7AE2B",order:3},{id:"s4",name:"Negociere",color:"#F69008",order:4},{id:"s5",name:"Câștigat",color:"#0CA437",order:5},{id:"s6",name:"Pierdut",color:"#D80F17",order:6}]},{id:"2",name:"Pipeline Enterprise",isDefault:!1,stages:[{id:"s7",name:"Inițial",color:"#99D126",order:1},{id:"s8",name:"Analiză Necesități",color:"#88C506",order:2},{id:"s9",name:"Workshop Tehnic",color:"#F7AE2B",order:3},{id:"s10",name:"Propunere",color:"#F69008",order:4},{id:"s11",name:"Revizuire Legală",color:"#C80002",order:5},{id:"s12",name:"Negociere",color:"#F69008",order:6},{id:"s13",name:"Câștigat",color:"#0CA437",order:7},{id:"s14",name:"Pierdut",color:"#D80F17",order:8}]}],A=[{id:"1",title:"Licențe ERP Enterprise",customerId:"1",customerName:"Acme SRL",pipelineId:"1",stageId:"s4",amount:25e4,currency:"RON",probability:75,expectedCloseDate:"2025-05-15",createdAt:"2025-03-20",ownerId:"u1",ownerName:"Alexandru Popa"},{id:"2",title:"Servicii Implementare",customerId:"1",customerName:"Acme SRL",pipelineId:"1",stageId:"s3",amount:12e4,currency:"RON",probability:60,expectedCloseDate:"2025-06-01",createdAt:"2025-03-25",ownerId:"u1",ownerName:"Alexandru Popa"},{id:"3",title:"Mentenanță Anuală",customerId:"1",customerName:"Acme SRL",pipelineId:"1",stageId:"s5",amount:75e3,currency:"RON",probability:100,expectedCloseDate:"2025-04-05",createdAt:"2025-02-15",actualCloseDate:"2025-04-01",ownerId:"u2",ownerName:"Maria Dinu"},{id:"4",title:"Licențe Software Dezvoltare",customerId:"2",customerName:"TechSoft Solutions",pipelineId:"1",stageId:"s2",amount:85e3,currency:"RON",probability:50,expectedCloseDate:"2025-05-30",createdAt:"2025-03-15",ownerId:"u3",ownerName:"Andrei Vasilescu"},{id:"5",title:"Servicii de Consultanță",customerId:"2",customerName:"TechSoft Solutions",pipelineId:"1",stageId:"s1",amount:45e3,currency:"RON",probability:30,expectedCloseDate:"2025-06-15",createdAt:"2025-04-05",ownerId:"u1",ownerName:"Alexandru Popa"},{id:"6",title:"Soluție Management Medical",customerId:"3",customerName:"MediCare Plus",pipelineId:"1",stageId:"s3",amount:32e4,currency:"RON",probability:65,expectedCloseDate:"2025-07-10",createdAt:"2025-03-01",ownerId:"u2",ownerName:"Maria Dinu"},{id:"7",title:"Proiect ERP Enterprise",customerId:"5",customerName:"AgriTech International",pipelineId:"2",stageId:"s10",amount:45e4,currency:"RON",probability:70,expectedCloseDate:"2025-08-01",createdAt:"2025-02-10",ownerId:"u1",ownerName:"Alexandru Popa"},{id:"8",title:"Implementare CRM Enterprise",customerId:"4",customerName:"Construct Expert",pipelineId:"2",stageId:"s8",amount:18e4,currency:"RON",probability:40,expectedCloseDate:"2025-07-15",createdAt:"2025-03-05",ownerId:"u3",ownerName:"Andrei Vasilescu"}],ie=()=>{const{toast:p}=q(),[h,T]=m.useState(""),[j,k]=m.useState(u[0].id),[i,N]=m.useState("all"),[n,g]=m.useState("all"),f=u.find(s=>s.id===j)||u[0],E=[...new Set(A.map(s=>s.customerName))],L=[...new Set(A.map(s=>s.ownerName))],w=A.filter(s=>{const t=s.title.toLowerCase().includes(h.toLowerCase())||s.customerName.toLowerCase().includes(h.toLowerCase()),r=s.pipelineId===j,a=i==="all"||s.customerName===i,l=n==="all"||s.ownerName===n;return t&&r&&a&&l}),z=f.stages.reduce((s,t)=>(s[t.id]=w.filter(r=>r.stageId===t.id),s),{}),V=w.reduce((s,t)=>s+t.amount,0),B=w.length,y=s=>new Intl.NumberFormat("ro-RO",{style:"currency",currency:"RON",maximumFractionDigits:0}).format(s),$=s=>{const t=new Date(s);return new Intl.DateTimeFormat("ro-RO",{year:"numeric",month:"short",day:"numeric"}).format(t)},S=()=>{p({title:"Adaugă oportunitate",description:"Funcționalitate în curând disponibilă."})},d=(s,t)=>{p({title:`Acțiune: ${s}`,description:`Pentru oportunitatea cu ID: ${t}`})},Q=(s,t)=>{var r;p({title:"Oportunitate mutată",description:`Oportunitatea a fost mutată în etapa: ${(r=f.stages.find(a=>a.id===t))==null?void 0:r.name}`})};return e.jsx(te,{activeTab:"deals",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(J,{className:"h-6 w-6 text-primary"}),e.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:"Oportunități"})]}),e.jsxs(x,{onClick:S,className:"bg-primary hover:bg-primary/90",children:[e.jsx(K,{className:"h-4 w-4 mr-2"}),"Adaugă Oportunitate"]})]}),e.jsxs("div",{className:"flex flex-col lg:flex-row gap-4 items-start",children:[e.jsxs("div",{className:"w-full lg:w-3/4 space-y-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(U,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-gray-500"}),e.jsx(W,{placeholder:"Caută după nume sau companie...",value:h,onChange:s=>T(s.target.value),className:"pl-9"})]}),e.jsxs(C,{value:j,onValueChange:k,children:[e.jsx(v,{className:"w-[180px]",children:e.jsx(b,{placeholder:"Alege pipeline"})}),e.jsx(I,{children:u.map(s=>e.jsx(c,{value:s.id,children:s.name},s.id))})]}),e.jsxs(P,{children:[e.jsx(R,{asChild:!0,children:e.jsxs(x,{variant:"outline",className:"flex items-center gap-1",children:[e.jsx(G,{className:"h-4 w-4 mr-1"}),"Filtre"]})}),e.jsxs(F,{align:"end",className:"w-[220px]",children:[e.jsx(H,{children:"Filtrează după"}),e.jsx(D,{}),e.jsxs("div",{className:"p-2",children:[e.jsx("p",{className:"text-sm font-medium mb-1",children:"Companie"}),e.jsxs(C,{value:i,onValueChange:N,children:[e.jsx(v,{className:"w-full",children:e.jsx(b,{placeholder:"Toate companiile"})}),e.jsxs(I,{children:[e.jsx(c,{value:"all",children:"Toate companiile"}),E.map(s=>e.jsx(c,{value:s,children:s},s))]})]})]}),e.jsxs("div",{className:"p-2 pt-0",children:[e.jsx("p",{className:"text-sm font-medium mb-1",children:"Proprietar"}),e.jsxs(C,{value:n,onValueChange:g,children:[e.jsx(v,{className:"w-full",children:e.jsx(b,{placeholder:"Toți proprietarii"})}),e.jsxs(I,{children:[e.jsx(c,{value:"all",children:"Toți proprietarii"}),L.map(s=>e.jsx(c,{value:s,children:s},s))]})]})]}),e.jsx(D,{}),e.jsx(o,{onClick:()=>{N("all"),g("all")},children:"Resetează toate filtrele"})]})]})]}),(i!=="all"||n!=="all")&&e.jsxs("div",{className:"flex flex-wrap gap-2",children:[i!=="all"&&e.jsxs("div",{className:"bg-primary/10 text-primary text-xs py-1 px-2.5 rounded-full flex items-center",children:["Companie: ",i,e.jsx("button",{className:"ml-1.5 text-primary/80 hover:text-primary",onClick:()=>N("all"),children:"✕"})]}),n!=="all"&&e.jsxs("div",{className:"bg-primary/10 text-primary text-xs py-1 px-2.5 rounded-full flex items-center",children:["Proprietar: ",n,e.jsx("button",{className:"ml-1.5 text-primary/80 hover:text-primary",onClick:()=>g("all"),children:"✕"})]})]})]}),e.jsx(O,{className:"w-full lg:w-1/4 shadow-sm",children:e.jsx(M,{className:"p-4",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Total oportunități"}),e.jsx("p",{className:"text-2xl font-bold",children:B})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Valoare totală"}),e.jsx("p",{className:"text-2xl font-bold",children:y(V)})]})]})})})]}),e.jsx("div",{className:"flex h-[calc(100vh-280px)] min-h-[500px] overflow-x-auto pb-4",children:f.stages.map(s=>{const t=z[s.id]||[],r=t.reduce((a,l)=>a+l.amount,0);return e.jsxs("div",{className:"flex-shrink-0 w-[300px] mx-2 first:ml-0 last:mr-0",onDragOver:a=>a.preventDefault(),onDrop:a=>{const l=a.dataTransfer.getData("dealId");Q(l,s.id)},children:[e.jsxs("div",{className:"rounded-t-md p-2 font-medium text-sm flex justify-between items-center",style:{backgroundColor:`${s.color}20`,color:s.color},children:[e.jsx("span",{children:s.name}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{children:t.length}),e.jsx(X,{className:"h-3.5 w-3.5"})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-b-md h-full p-2 border border-t-0",children:[e.jsx("div",{className:"text-xs text-gray-500 mb-2 flex justify-between",children:e.jsxs("span",{children:["Valoare: ",y(r)]})}),e.jsx(Y,{className:"h-[calc(100vh-340px)] min-h-[440px] rounded-md",children:e.jsxs("div",{className:"pr-4 space-y-3",children:[t.map(a=>e.jsx(O,{className:"shadow-sm cursor-pointer hover:shadow-md transition-shadow",draggable:!0,onDragStart:l=>{l.dataTransfer.setData("dealId",a.id)},children:e.jsxs(M,{className:"p-3",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx("h3",{className:"font-medium text-sm",children:a.title}),e.jsxs(P,{children:[e.jsx(R,{asChild:!0,children:e.jsxs(x,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0",children:[e.jsx(Z,{className:"h-3.5 w-3.5"}),e.jsx("span",{className:"sr-only",children:"Acțiuni"})]})}),e.jsxs(F,{align:"end",children:[e.jsx(o,{onClick:()=>d("edit",a.id),children:"Editează"}),e.jsx(o,{onClick:()=>d("win",a.id),children:"Marchează câștigat"}),e.jsx(o,{onClick:()=>d("lose",a.id),children:"Marchează pierdut"}),e.jsx(D,{}),e.jsx(o,{onClick:()=>d("delete",a.id),className:"text-red-600",children:"Șterge"})]})]})]}),e.jsxs("div",{className:"flex items-center mt-2 text-xs text-gray-500",children:[e.jsx(_,{className:"h-3 w-3 mr-1"}),e.jsx("span",{children:a.customerName})]}),e.jsxs("div",{className:"mt-3 flex justify-between items-baseline",children:[e.jsx("span",{className:"font-medium",children:y(a.amount)}),e.jsxs(ee,{variant:"outline",className:"text-xs",children:[a.probability,"%"]})]}),e.jsxs("div",{className:"mt-2 text-xs text-gray-500 flex items-center",children:[e.jsx(se,{className:"h-3 w-3 mr-1"}),e.jsxs("span",{children:["Închidere: ",$(a.expectedCloseDate)]})]})]})},a.id)),e.jsxs(x,{variant:"ghost",className:"w-full justify-start text-xs text-gray-500",onClick:()=>S(),children:[e.jsx(ae,{className:"h-3.5 w-3.5 mr-1"}),"Adaugă oportunitate în ",s.name]})]})})]})]},s.id)})})]})})};export{ie as default};
