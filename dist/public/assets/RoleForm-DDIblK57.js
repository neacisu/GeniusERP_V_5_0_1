import{r as f,z as t,f as z,t as R,j as e,g as D,h as P,F as A,i as o,k as l,l as m,m as u,I as g,n as N,o as b,T as E,p as I,q,s as B,B as M,v as Q}from"./index-BzQLEEGE.js";function V({role:a,permissions:C,onSubmit:v,isPending:x}){const[c,y]=f.useState(""),F=t.object({name:t.string().min(2,"Numele trebuie să aibă minim 2 caractere"),description:t.string().optional(),permissions:t.array(t.string()).default([])}),i=z({resolver:R(F),defaultValues:{name:"",description:"",permissions:[]}});f.useEffect(()=>{a&&i.reset({name:a.name,description:a.description||"",permissions:[]})},[a,i]);const S=s=>{const r={name:s.name,description:s.description,permissions:s.permissions};v(r)},h=C.filter(s=>{if(!c)return!0;const r=c.toLowerCase();return s.name.toLowerCase().includes(r)||s.description&&s.description.toLowerCase().includes(r)||s.module&&s.module.toLowerCase().includes(r)}).reduce((s,r)=>{const n=r.module||"Altele";return s[n]||(s[n]=[]),s[n].push(r),s},{}),w=Object.keys(h).sort(),j=(a==null?void 0:a.name)==="admin"||(a==null?void 0:a.name)==="user";return e.jsx(D,{children:e.jsx(P,{className:"pt-6",children:e.jsx(A,{...i,children:e.jsxs("form",{onSubmit:i.handleSubmit(S),className:"space-y-8",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-6",children:[e.jsx(o,{control:i.control,name:"name",render:({field:s})=>e.jsxs(l,{children:[e.jsx(m,{children:"Nume rol"}),e.jsx(u,{children:e.jsx(g,{placeholder:"Nume rol",...s,disabled:j})}),e.jsx(N,{}),j&&e.jsx(b,{children:"Rolurile de sistem nu pot fi redenumite"})]})}),e.jsx(o,{control:i.control,name:"description",render:({field:s})=>e.jsxs(l,{children:[e.jsx(m,{children:"Descriere"}),e.jsx(u,{children:e.jsx(E,{placeholder:"Descriere rol",className:"resize-none",...s})}),e.jsx(N,{})]})})]}),e.jsx(I,{}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-medium",children:"Permisiuni"}),e.jsxs("div",{className:"w-[250px] relative",children:[e.jsx(q,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(g,{placeholder:"Caută permisiuni...",className:"pl-8",value:c,onChange:s=>y(s.target.value)})]})]}),e.jsx("div",{className:"space-y-6",children:w.map(s=>e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-muted-foreground mb-3",children:s}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:h[s].map(r=>e.jsx(o,{control:i.control,name:"permissions",render:({field:n})=>{var p;return e.jsxs(l,{className:"flex flex-row items-start space-x-3 space-y-0 rounded-md border p-4",children:[e.jsx(u,{children:e.jsx(B,{checked:(p=n.value)==null?void 0:p.includes(r.id),onCheckedChange:L=>{const d=[...n.value];L?d.includes(r.id)||n.onChange([...d,r.id]):n.onChange(d.filter(k=>k!==r.id))}})}),e.jsxs("div",{className:"space-y-1 leading-none",children:[e.jsx(m,{children:r.name}),r.description&&e.jsx(b,{children:r.description})]})]})}},r.id))})]},s))})]}),e.jsx("div",{className:"flex justify-start",children:e.jsx(M,{type:"submit",disabled:x,children:x?e.jsxs(e.Fragment,{children:[e.jsx(Q,{className:"mr-2 h-4 w-4 animate-spin"}),"Se salvează..."]}):a?"Actualizează rolul":"Adaugă rol"})})]})})})})}export{V as R};
