import{a as le,c_ as ie,d3 as ce,d4 as re,d0 as a,dR as g,f as te,t as de,z as c,j as e,B as p,aQ as oe,cn as _,F as me,g as v,_ as S,$ as f,a0 as b,h as y,i as o,k as i,l as r,m as t,I as D,o as m,n as x,T as O,a3 as I,a4 as A,a5 as E,a6 as L,a7 as j,aH as G,bN as k,d6 as $,d5 as B,dS as W,dT as w,bu as N,af as xe,ag as he,ah as q,ax as Q,aj as Y,s as F,b2 as je,b3 as ue,aR as J,Y as K,ay as pe,b4 as ge,b5 as Ne,cp as Ce,c$ as X}from"./index-BzQLEEGE.js";const ve=c.object({name:c.string().min(3,{message:"Numele campaniei trebuie să aibă cel puțin 3 caractere."}),description:c.string().optional(),type:c.nativeEnum(a,{errorMap:()=>({message:"Selectați tipul campaniei."})}),audienceType:c.nativeEnum(g,{errorMap:()=>({message:"Selectați tipul de audiență."})}),audienceId:c.string().optional(),templateId:c.string().optional(),subject:c.string().optional(),content:c.string().optional(),schedulingMode:c.enum(["now","scheduled"]),scheduledAt:c.date().optional(),channels:c.array(c.string()).min(1,{message:"Selectați cel puțin un canal de comunicare."})}),be=()=>{const[Se,P]=le(),{createCampaign:Z}=ie(),{segments:ee}=ce(),{templates:se}=re(),V=new URLSearchParams(window.location.search),ae=V.get("templateId"),ne=V.get("segmentId"),H={type:a.EMAIL,audienceType:g.ALL_CUSTOMERS,schedulingMode:"now",channels:[a.EMAIL],templateId:ae||void 0,audienceId:ne||void 0},l=te({resolver:de(ve),defaultValues:H}),T=l.watch("type"),z=l.watch("audienceType"),U=l.watch("schedulingMode"),R=async s=>{try{const n={name:s.name,description:s.description,type:s.type,audienceType:s.audienceType,audienceId:s.audienceId,templateId:s.templateId,subject:s.subject,content:s.content,scheduledAt:s.schedulingMode==="scheduled"?s.scheduledAt:void 0,status:s.schedulingMode==="now"?X.ACTIVE:X.SCHEDULED,channels:s.channels};await Z.mutateAsync(n),P("/marketing/campaigns")}catch(n){console.error("Error creating campaign:",n)}};return e.jsxs("div",{className:"flex-1 space-y-4 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsxs(p,{variant:"ghost",size:"icon",className:"mr-2",onClick:()=>P("/marketing/campaigns"),children:[e.jsx(oe,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Înapoi"})]}),e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Campanie Nouă"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(p,{variant:"outline",onClick:()=>l.reset(H),children:"Resetează"}),e.jsxs(p,{onClick:l.handleSubmit(R),children:[e.jsx(_,{className:"mr-2 h-4 w-4"}),"Salvează"]})]})]}),e.jsx(me,{...l,children:e.jsxs("form",{onSubmit:l.handleSubmit(R),className:"space-y-6",children:[e.jsxs(v,{children:[e.jsxs(S,{children:[e.jsx(f,{children:"Informații Generale"}),e.jsx(b,{children:"Configurați detaliile de bază ale campaniei."})]}),e.jsxs(y,{className:"space-y-6",children:[e.jsx(o,{control:l.control,name:"name",render:({field:s})=>e.jsxs(i,{children:[e.jsx(r,{children:"Nume Campanie"}),e.jsx(t,{children:e.jsx(D,{placeholder:"Nume campanie",...s})}),e.jsx(m,{children:"Numele campaniei va fi utilizat pentru identificare și analiză."}),e.jsx(x,{})]})}),e.jsx(o,{control:l.control,name:"description",render:({field:s})=>e.jsxs(i,{children:[e.jsx(r,{children:"Descriere"}),e.jsx(t,{children:e.jsx(O,{placeholder:"Descrieți campania",className:"resize-none min-h-[100px]",...s})}),e.jsx(m,{children:"O scurtă descriere a scopului campaniei."}),e.jsx(x,{})]})}),e.jsx(o,{control:l.control,name:"type",render:({field:s})=>e.jsxs(i,{children:[e.jsx(r,{children:"Tip Campanie"}),e.jsx(t,{children:e.jsxs(I,{onValueChange:s.onChange,defaultValue:s.value,children:[e.jsx(A,{children:e.jsx(E,{placeholder:"Selectați tipul campaniei"})}),e.jsxs(L,{children:[e.jsx(j,{value:a.EMAIL,children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(G,{className:"mr-2 h-4 w-4"}),e.jsx("span",{children:"Email"})]})}),e.jsx(j,{value:a.SMS,children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(k,{className:"mr-2 h-4 w-4"}),e.jsx("span",{children:"SMS"})]})}),e.jsx(j,{value:a.SOCIAL,children:e.jsxs("div",{className:"flex items-center",children:[e.jsx($,{className:"mr-2 h-4 w-4"}),e.jsx("span",{children:"Social Media"})]})}),e.jsx(j,{value:a.PUSH,children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(B,{className:"mr-2 h-4 w-4"}),e.jsx("span",{children:"Push Notificare"})]})}),e.jsx(j,{value:a.WHATSAPP,children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(k,{className:"mr-2 h-4 w-4"}),e.jsx("span",{children:"WhatsApp"})]})}),e.jsx(j,{value:a.MULTI_CHANNEL,children:e.jsxs("div",{className:"flex items-center",children:[e.jsx($,{className:"mr-2 h-4 w-4"}),e.jsx("span",{children:"Multi-canal"})]})})]})]})}),e.jsx(m,{children:"Selectați tipul principal al campaniei. Aceasta determină formatul și caracteristicile disponibile."}),e.jsx(x,{})]})})]})]}),e.jsxs(v,{children:[e.jsxs(S,{children:[e.jsx(f,{children:"Audiență"}),e.jsx(b,{children:"Configurați cine va primi mesajele campaniei."})]}),e.jsxs(y,{className:"space-y-6",children:[e.jsx(o,{control:l.control,name:"audienceType",render:({field:s})=>e.jsxs(i,{className:"space-y-3",children:[e.jsx(r,{children:"Tip Audiență"}),e.jsx(t,{children:e.jsxs(W,{onValueChange:s.onChange,defaultValue:s.value,className:"flex flex-col space-y-1",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(w,{value:g.ALL_CUSTOMERS,id:"all"}),e.jsx(N,{htmlFor:"all",children:"Toți Clienții"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(w,{value:g.SEGMENT,id:"segment"}),e.jsx(N,{htmlFor:"segment",children:"Segment"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(w,{value:g.CUSTOM,id:"custom"}),e.jsx(N,{htmlFor:"custom",children:"Audiență personalizată"})]})]})}),e.jsx(x,{})]})}),z===g.SEGMENT&&e.jsx(o,{control:l.control,name:"audienceId",render:({field:s})=>e.jsxs(i,{children:[e.jsx(r,{children:"Segment"}),e.jsx(t,{children:e.jsxs(I,{onValueChange:s.onChange,defaultValue:s.value,children:[e.jsx(A,{children:e.jsx(E,{placeholder:"Selectați segmentul"})}),e.jsx(L,{children:ee.map(n=>e.jsx(j,{value:n.id,children:n.name},n.id))})]})}),e.jsx(m,{children:e.jsx(p,{variant:"link",className:"p-0 h-auto",asChild:!0,children:e.jsx("a",{href:"/marketing/segments/new",target:"_blank",rel:"noopener noreferrer",children:"Creați un segment nou"})})}),e.jsx(x,{})]})}),z===g.CUSTOM&&e.jsx("div",{className:"bg-amber-50 border border-amber-200 rounded-md p-4",children:e.jsx("p",{className:"text-amber-800 text-sm",children:"Configurarea audienței personalizate va fi disponibilă în curând. Între timp, vă recomandăm să folosiți segmente predefinite."})})]})]}),e.jsxs(v,{children:[e.jsxs(S,{children:[e.jsx(f,{children:"Conținut"}),e.jsx(b,{children:"Configurați conținutul campaniei."})]}),e.jsx(y,{className:"space-y-6",children:e.jsxs(xe,{defaultValue:"template",className:"w-full",children:[e.jsxs(he,{className:"grid w-full grid-cols-2",children:[e.jsxs(q,{value:"template",children:[e.jsx(Q,{className:"mr-2 h-4 w-4"}),"Șablon"]}),e.jsxs(q,{value:"custom",children:[e.jsx(Q,{className:"mr-2 h-4 w-4"}),"Conținut personalizat"]})]}),e.jsx(Y,{value:"template",className:"space-y-4",children:e.jsx(o,{control:l.control,name:"templateId",render:({field:s})=>e.jsxs(i,{children:[e.jsx(r,{children:"Șablon"}),e.jsx(t,{children:e.jsxs(I,{onValueChange:s.onChange,defaultValue:s.value,children:[e.jsx(A,{children:e.jsx(E,{placeholder:"Selectați un șablon"})}),e.jsx(L,{children:se.filter(n=>n.type===T||T===a.MULTI_CHANNEL).map(n=>e.jsx(j,{value:n.id,children:n.name},n.id))})]})}),e.jsx(m,{children:e.jsx(p,{variant:"link",className:"p-0 h-auto",asChild:!0,children:e.jsx("a",{href:"/marketing/templates/new",target:"_blank",rel:"noopener noreferrer",children:"Creați un șablon nou"})})}),e.jsx(x,{})]})})}),e.jsxs(Y,{value:"custom",className:"space-y-4",children:[(T===a.EMAIL||T===a.MULTI_CHANNEL)&&e.jsx(o,{control:l.control,name:"subject",render:({field:s})=>e.jsxs(i,{children:[e.jsx(r,{children:"Subiect Email"}),e.jsx(t,{children:e.jsx(D,{placeholder:"Introduceți subiectul",...s})}),e.jsx(x,{})]})}),e.jsx(o,{control:l.control,name:"content",render:({field:s})=>e.jsxs(i,{children:[e.jsx(r,{children:"Conținut"}),e.jsx(t,{children:e.jsx(O,{placeholder:"Introduceți conținutul mesajului",className:"min-h-[200px]",...s})}),e.jsxs(m,{children:["Puteți folosi variabile precum ","{nume}",", ","{prenume}"," pentru personalizare."]}),e.jsx(x,{})]})})]})]})})]}),e.jsxs(v,{children:[e.jsxs(S,{children:[e.jsx(f,{children:"Canale"}),e.jsx(b,{children:"Selectați canalele prin care se va distribui campania."})]}),e.jsx(y,{children:e.jsx(o,{control:l.control,name:"channels",render:({field:s})=>{var n,h,M;return e.jsxs(i,{children:[e.jsxs("div",{className:"mb-4",children:[e.jsx(r,{children:"Canale de distribuție"}),e.jsx(m,{children:"Selectați unul sau mai multe canale prin care să trimiteți campania."})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[e.jsxs(i,{className:"flex flex-row items-start space-x-3 space-y-0 rounded-md border p-4",children:[e.jsx(t,{children:e.jsx(F,{checked:(n=s.value)==null?void 0:n.includes(a.EMAIL),onCheckedChange:u=>{const d=[...s.value||[]];u?d.includes(a.EMAIL)||s.onChange([...d,a.EMAIL]):s.onChange(d.filter(C=>C!==a.EMAIL))}})}),e.jsxs("div",{className:"space-y-1 leading-none",children:[e.jsxs(r,{className:"flex items-center",children:[e.jsx(G,{className:"mr-2 h-4 w-4"}),"Email"]}),e.jsx(m,{children:"Trimite prin email"})]})]}),e.jsxs(i,{className:"flex flex-row items-start space-x-3 space-y-0 rounded-md border p-4",children:[e.jsx(t,{children:e.jsx(F,{checked:(h=s.value)==null?void 0:h.includes(a.SMS),onCheckedChange:u=>{const d=[...s.value||[]];u?d.includes(a.SMS)||s.onChange([...d,a.SMS]):s.onChange(d.filter(C=>C!==a.SMS))}})}),e.jsxs("div",{className:"space-y-1 leading-none",children:[e.jsxs(r,{className:"flex items-center",children:[e.jsx(k,{className:"mr-2 h-4 w-4"}),"SMS"]}),e.jsx(m,{children:"Trimite prin SMS"})]})]}),e.jsxs(i,{className:"flex flex-row items-start space-x-3 space-y-0 rounded-md border p-4",children:[e.jsx(t,{children:e.jsx(F,{checked:(M=s.value)==null?void 0:M.includes(a.PUSH),onCheckedChange:u=>{const d=[...s.value||[]];u?d.includes(a.PUSH)||s.onChange([...d,a.PUSH]):s.onChange(d.filter(C=>C!==a.PUSH))}})}),e.jsxs("div",{className:"space-y-1 leading-none",children:[e.jsxs(r,{className:"flex items-center",children:[e.jsx(B,{className:"mr-2 h-4 w-4"}),"Push"]}),e.jsx(m,{children:"Trimite notificări push"})]})]})]}),e.jsx(x,{})]})}})})]}),e.jsxs(v,{children:[e.jsxs(S,{children:[e.jsx(f,{children:"Programare"}),e.jsx(b,{children:"Când doriți să trimiteți campania."})]}),e.jsxs(y,{children:[e.jsx(o,{control:l.control,name:"schedulingMode",render:({field:s})=>e.jsxs(i,{className:"space-y-3",children:[e.jsx("div",{className:"flex items-center space-x-2",children:e.jsxs(W,{onValueChange:s.onChange,defaultValue:s.value,className:"flex flex-col space-y-1",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(w,{value:"now",id:"now"}),e.jsx(N,{htmlFor:"now",children:"Trimite imediat"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(w,{value:"scheduled",id:"scheduled"}),e.jsx(N,{htmlFor:"scheduled",children:"Programează pentru mai târziu"})]})]})}),e.jsx(x,{})]})}),U==="scheduled"&&e.jsx(o,{control:l.control,name:"scheduledAt",render:({field:s})=>e.jsxs(i,{className:"flex flex-col mt-4",children:[e.jsx(r,{children:"Data programată"}),e.jsxs(je,{children:[e.jsx(ue,{asChild:!0,children:e.jsx(t,{children:e.jsxs(p,{variant:"outline",className:"w-full pl-3 text-left font-normal",children:[s.value?J(s.value,"PPP HH:mm",{locale:K}):e.jsx("span",{children:"Selectați data și ora"}),e.jsx(pe,{className:"ml-auto h-4 w-4 opacity-50"})]})})}),e.jsxs(ge,{className:"w-auto p-0",align:"start",children:[e.jsx(Ne,{mode:"single",selected:s.value,onSelect:s.onChange,initialFocus:!0,locale:K}),e.jsx("div",{className:"p-3 border-t",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(N,{children:"Ora:"}),e.jsxs(I,{value:s.value?J(s.value,"HH:mm"):void 0,onValueChange:n=>{const[h,M]=n.split(":").map(Number),u=s.value||new Date;u.setHours(h),u.setMinutes(M),s.onChange(u)},children:[e.jsx(A,{className:"w-[120px]",children:e.jsx(E,{placeholder:"Selectați ora"})}),e.jsx(L,{children:Array.from({length:24}).map((n,h)=>e.jsxs(Ce.Fragment,{children:[e.jsxs(j,{value:`${h.toString().padStart(2,"0")}:00`,children:[h.toString().padStart(2,"0"),":00"]}),e.jsxs(j,{value:`${h.toString().padStart(2,"0")}:30`,children:[h.toString().padStart(2,"0"),":30"]})]},h))})]})]})})]})]}),e.jsx(m,{children:"Campania va fi trimisă la data și ora selectată."}),e.jsx(x,{})]})})]})]}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx(p,{variant:"outline",type:"button",onClick:()=>P("/marketing/campaigns"),children:"Anulează"}),e.jsxs(p,{type:"submit",children:[e.jsx(_,{className:"mr-2 h-4 w-4"}),U==="now"?"Trimite Campanie":"Programează Campanie"]})]})]})})]})};export{be as default};
