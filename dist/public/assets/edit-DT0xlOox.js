import{a as O,j as e,B as t,a1 as q,b7 as G,b9 as W,u as Q,dU as X,c_ as J,f as K,t as Y,z as j,r as Z,c$ as r,aQ as D,S as g,g as u,_ as L,h as p,be as M,ai as I,F as ee,$ as P,a0 as T,i as v,k as x,l as o,m as N,I as $,o as f,n as S,T as R,bu as se,d0 as i,aH as _,bN as F,d6 as B,d5 as V,s as U}from"./index-BzQLEEGE.js";const ae=({cancelHref:w,cancelLabel:H="Anulează",submitLabel:l="Salvează",isSubmitting:h=!1,isDirty:s=!1,resetForm:k,onCancel:b,onSubmit:n,className:z="",align:E="end"})=>{const[a,m]=O(),A=()=>{b?b():w&&m(w)};let d="";switch(E){case"start":d="justify-start";break;case"center":d="justify-center";break;case"between":d="justify-between";break;case"end":default:d="justify-end"}return e.jsxs("div",{className:`flex items-center space-x-2 ${d} ${z}`,children:[k&&e.jsxs(t,{type:"button",variant:"outline",onClick:k,disabled:h||!s,children:[e.jsx(q,{className:"mr-2 h-4 w-4"}),"Resetează"]}),e.jsxs(t,{type:"button",variant:"outline",onClick:A,disabled:h,children:[e.jsx(G,{className:"mr-2 h-4 w-4"}),H]}),e.jsx(t,{type:n?"button":"submit",onClick:n,disabled:h,children:h?e.jsxs(e.Fragment,{children:[e.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Se procesează..."]}):e.jsxs(e.Fragment,{children:[e.jsx(W,{className:"mr-2 h-4 w-4"}),l]})})]})},ie=j.object({name:j.string().min(3,{message:"Numele campaniei trebuie să aibă cel puțin 3 caractere."}),description:j.string().optional(),subject:j.string().optional(),content:j.string().optional(),channels:j.array(j.string()).min(1,{message:"Selectați cel puțin un canal de comunicare."})}),ce=({id:w})=>{const[H,l]=O(),{toast:h}=Q(),{campaign:s,isLoading:k}=X(w),{updateCampaign:b}=J(),n=K({resolver:Y(ie),defaultValues:{name:"",description:"",subject:"",content:"",channels:[]}});Z.useEffect(()=>{s&&n.reset({name:s.name,description:s.description||"",subject:s.subject||"",content:s.content||"",channels:s.channels||[]})},[s,n]);const z=s&&(s.status===r.DRAFT||s.status===r.SCHEDULED||s.status===r.PAUSED),E=async a=>{if(s)try{const m={name:a.name,description:a.description,subject:a.subject,content:a.content,channels:a.channels};await b.mutateAsync({id:s.id,data:m}),h({title:"Campanie actualizată",description:"Campania a fost actualizată cu succes."}),l(`/marketing/campaigns/${s.id}`)}catch(m){console.error("Error updating campaign:",m),h({title:"Eroare",description:"A apărut o eroare la actualizarea campaniei.",variant:"destructive"})}};return k?e.jsxs("div",{className:"flex-1 space-y-4 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(t,{variant:"ghost",size:"icon",className:"mr-2",children:e.jsx(D,{className:"h-4 w-4"})}),e.jsx(g,{className:"h-9 w-64"})]}),e.jsx(g,{className:"h-10 w-24"})]}),e.jsxs(u,{children:[e.jsx(L,{children:e.jsx(g,{className:"h-6 w-48"})}),e.jsxs(p,{className:"space-y-8",children:[e.jsx(g,{className:"h-24 w-full"}),e.jsx(g,{className:"h-24 w-full"}),e.jsx(g,{className:"h-64 w-full"})]})]})]}):s?z?e.jsxs("div",{className:"flex-1 space-y-4 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsxs(t,{variant:"ghost",size:"icon",className:"mr-2",onClick:()=>l(`/marketing/campaigns/${s.id}`),children:[e.jsx(D,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Înapoi"})]}),e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Editare Campanie"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(t,{variant:"outline",onClick:()=>l(`/marketing/campaigns/${s.id}`),children:"Anulează"}),e.jsxs(t,{onClick:n.handleSubmit(E),children:[e.jsx(W,{className:"mr-2 h-4 w-4"}),"Salvează"]})]})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(I,{className:s.status===r.DRAFT?"bg-gray-200 text-gray-800":s.status===r.SCHEDULED?"bg-blue-100 text-blue-800":s.status===r.PAUSED?"bg-yellow-100 text-yellow-800":"",variant:"outline",children:s.status===r.DRAFT?"Ciornă":s.status===r.SCHEDULED?"Programată":s.status===r.PAUSED?"Pausată":s.status}),s.status===r.SCHEDULED&&s.scheduledAt&&e.jsxs("span",{className:"ml-2 text-sm text-muted-foreground",children:["Programată pentru ",new Date(s.scheduledAt).toLocaleDateString("ro-RO",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})]})]}),e.jsx(u,{className:"bg-amber-50 border-amber-200",children:e.jsx(p,{className:"p-4",children:e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx(M,{className:"h-5 w-5 text-amber-500 flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-amber-800 font-medium",children:"Limitări de editare"}),e.jsx("p",{className:"text-amber-700 text-sm mt-1",children:"În această etapă, puteți edita doar numele, descrierea, subiectul, conținutul și canalele campaniei. Tipul campaniei, tipul audienței și programarea nu pot fi modificate. Pentru modificări majore, vă recomandăm să creați o nouă campanie."})]})]})})}),e.jsx(ee,{...n,children:e.jsxs("form",{onSubmit:n.handleSubmit(E),className:"space-y-6",children:[e.jsxs(u,{children:[e.jsxs(L,{children:[e.jsx(P,{children:"Informații Generale"}),e.jsx(T,{children:"Configurați detaliile de bază ale campaniei."})]}),e.jsxs(p,{className:"space-y-6",children:[e.jsx(v,{control:n.control,name:"name",render:({field:a})=>e.jsxs(x,{children:[e.jsx(o,{children:"Nume Campanie"}),e.jsx(N,{children:e.jsx($,{placeholder:"Nume campanie",...a})}),e.jsx(f,{children:"Numele campaniei va fi utilizat pentru identificare și analiză."}),e.jsx(S,{})]})}),e.jsx(v,{control:n.control,name:"description",render:({field:a})=>e.jsxs(x,{children:[e.jsx(o,{children:"Descriere"}),e.jsx(N,{children:e.jsx(R,{placeholder:"Descrieți campania",className:"resize-none min-h-[100px]",...a})}),e.jsx(f,{children:"O scurtă descriere a scopului campaniei."}),e.jsx(S,{})]})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(se,{children:"Tip Campanie (read-only)"}),e.jsx("div",{className:"flex items-center h-10 px-3 rounded-md border border-input bg-muted/50",children:s.type===i.EMAIL?e.jsxs("div",{className:"flex items-center",children:[e.jsx(_,{className:"mr-2 h-4 w-4"}),e.jsx("span",{children:"Email"})]}):s.type===i.SMS?e.jsxs("div",{className:"flex items-center",children:[e.jsx(F,{className:"mr-2 h-4 w-4"}),e.jsx("span",{children:"SMS"})]}):s.type===i.SOCIAL?e.jsxs("div",{className:"flex items-center",children:[e.jsx(B,{className:"mr-2 h-4 w-4"}),e.jsx("span",{children:"Social Media"})]}):s.type===i.PUSH?e.jsxs("div",{className:"flex items-center",children:[e.jsx(V,{className:"mr-2 h-4 w-4"}),e.jsx("span",{children:"Push Notificare"})]}):s.type===i.WHATSAPP?e.jsxs("div",{className:"flex items-center",children:[e.jsx(F,{className:"mr-2 h-4 w-4"}),e.jsx("span",{children:"WhatsApp"})]}):s.type===i.MULTI_CHANNEL?e.jsxs("div",{className:"flex items-center",children:[e.jsx(B,{className:"mr-2 h-4 w-4"}),e.jsx("span",{children:"Multi-canal"})]}):s.type}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Tipul campaniei nu poate fi modificat. Pentru a schimba tipul, creați o nouă campanie."})]})]})]}),e.jsxs(u,{children:[e.jsxs(L,{children:[e.jsx(P,{children:"Conținut"}),e.jsx(T,{children:"Editați conținutul campaniei."})]}),e.jsxs(p,{className:"space-y-6",children:[(s.type===i.EMAIL||s.type===i.MULTI_CHANNEL)&&e.jsx(v,{control:n.control,name:"subject",render:({field:a})=>e.jsxs(x,{children:[e.jsx(o,{children:"Subiect Email"}),e.jsx(N,{children:e.jsx($,{placeholder:"Introduceți subiectul",...a})}),e.jsx(S,{})]})}),e.jsx(v,{control:n.control,name:"content",render:({field:a})=>e.jsxs(x,{children:[e.jsx(o,{children:"Conținut"}),e.jsx(N,{children:e.jsx(R,{placeholder:"Introduceți conținutul mesajului",className:"min-h-[200px]",...a})}),e.jsxs(f,{children:["Puteți folosi variabile precum ","{nume}",", ","{prenume}"," pentru personalizare."]}),e.jsx(S,{})]})})]})]}),e.jsxs(u,{children:[e.jsxs(L,{children:[e.jsx(P,{children:"Canale"}),e.jsx(T,{children:"Selectați canalele prin care se va distribui campania."})]}),e.jsx(p,{children:e.jsx(v,{control:n.control,name:"channels",render:({field:a})=>{var m,A,d;return e.jsxs(x,{children:[e.jsxs("div",{className:"mb-4",children:[e.jsx(o,{children:"Canale de distribuție"}),e.jsx(f,{children:"Selectați unul sau mai multe canale prin care să trimiteți campania."})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[e.jsxs(x,{className:"flex flex-row items-start space-x-3 space-y-0 rounded-md border p-4",children:[e.jsx(N,{children:e.jsx(U,{checked:(m=a.value)==null?void 0:m.includes(i.EMAIL),onCheckedChange:C=>{const c=[...a.value||[]];C?c.includes(i.EMAIL)||a.onChange([...c,i.EMAIL]):a.onChange(c.filter(y=>y!==i.EMAIL))}})}),e.jsxs("div",{className:"space-y-1 leading-none",children:[e.jsxs(o,{className:"flex items-center",children:[e.jsx(_,{className:"mr-2 h-4 w-4"}),"Email"]}),e.jsx(f,{children:"Trimite prin email"})]})]}),e.jsxs(x,{className:"flex flex-row items-start space-x-3 space-y-0 rounded-md border p-4",children:[e.jsx(N,{children:e.jsx(U,{checked:(A=a.value)==null?void 0:A.includes(i.SMS),onCheckedChange:C=>{const c=[...a.value||[]];C?c.includes(i.SMS)||a.onChange([...c,i.SMS]):a.onChange(c.filter(y=>y!==i.SMS))}})}),e.jsxs("div",{className:"space-y-1 leading-none",children:[e.jsxs(o,{className:"flex items-center",children:[e.jsx(F,{className:"mr-2 h-4 w-4"}),"SMS"]}),e.jsx(f,{children:"Trimite prin SMS"})]})]}),e.jsxs(x,{className:"flex flex-row items-start space-x-3 space-y-0 rounded-md border p-4",children:[e.jsx(N,{children:e.jsx(U,{checked:(d=a.value)==null?void 0:d.includes(i.PUSH),onCheckedChange:C=>{const c=[...a.value||[]];C?c.includes(i.PUSH)||a.onChange([...c,i.PUSH]):a.onChange(c.filter(y=>y!==i.PUSH))}})}),e.jsxs("div",{className:"space-y-1 leading-none",children:[e.jsxs(o,{className:"flex items-center",children:[e.jsx(V,{className:"mr-2 h-4 w-4"}),"Push"]}),e.jsx(f,{children:"Trimite notificări push"})]})]})]}),e.jsx(S,{})]})}})})]}),e.jsx(ae,{cancelHref:`/marketing/campaigns/${s.id}`,cancelLabel:"Anulează",submitLabel:"Salvează modificările",isSubmitting:b.isPending,isDirty:n.formState.isDirty,resetForm:()=>n.reset()})]})})]}):e.jsxs("div",{className:"flex-1 space-y-4 p-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center",children:[e.jsxs(t,{variant:"ghost",size:"icon",className:"mr-2",onClick:()=>l(`/marketing/campaigns/${s.id}`),children:[e.jsx(D,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Înapoi"})]}),e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Editare Campanie"})]})}),e.jsx(u,{children:e.jsxs(p,{className:"flex flex-col items-center justify-center h-64 space-y-4 py-10",children:[e.jsx(M,{className:"h-12 w-12 text-amber-500"}),e.jsx("h2",{className:"text-xl font-medium",children:"Campanie needitabilă"}),e.jsxs("p",{className:"text-muted-foreground text-center",children:["Această campanie nu poate fi editată deoarece este în starea ",e.jsx(I,{className:"ml-1",children:s.status})]}),e.jsx("p",{className:"text-muted-foreground text-center",children:"Doar campaniile în stările DRAFT, SCHEDULED sau PAUSED pot fi editate."}),e.jsx(t,{onClick:()=>l(`/marketing/campaigns/${s.id}`),children:"Înapoi la Detalii Campanie"})]})})]}):e.jsxs("div",{className:"flex-1 space-y-4 p-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center",children:[e.jsxs(t,{variant:"ghost",size:"icon",className:"mr-2",onClick:()=>l("/marketing/campaigns"),children:[e.jsx(D,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Înapoi"})]}),e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Editare Campanie"})]})}),e.jsx(u,{children:e.jsxs(p,{className:"flex flex-col items-center justify-center h-64 space-y-4 py-10",children:[e.jsx(M,{className:"h-12 w-12 text-amber-500"}),e.jsx("h2",{className:"text-xl font-medium",children:"Campanie negăsită"}),e.jsx("p",{className:"text-muted-foreground text-center",children:"Campania cu ID-ul specificat nu a fost găsită. Este posibil să fi fost ștearsă sau să nu aveți acces la ea."}),e.jsx(t,{onClick:()=>l("/marketing/campaigns"),children:"Înapoi la Campanii"})]})})]})};export{ce as default};
